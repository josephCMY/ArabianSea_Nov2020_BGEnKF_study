# CRTM REL 2.3.0 with PSU ADAPT Microwave-related Coefficients

## About
MW coefficients generated by Scott Sieron and Yinghui Lu.

CRTM code is currently managed by Yunji Zhang.



# Compilation instructions
**NOTE:** There are two different compilation instructions. 
One written by Yunji Zhang, the other one by Man-Yau Chan.
Try Yunji Zhang's instructions first. 
If his does not work, try Man-Yau Chan's compilation instructions.


## Yunji Zhang's compilation instructions (TRY THIS FIRST)
Edited by Man-Yau Chan on Mar 28, 2021

1) Enter the CRTM directory (`cd PSU-EnKF_w_satellites/fortran_src/crtm_v2.3.0/`)

2) Download coefficients tarball file for CRTM by running `./download_coefficients.sh`.

3) Untar the coefficients tarball file by running `tar -xvf coefficients.*.tar`.

4) Setup relevant environment via `. config-setup/COMPILER.setup`.
Replace `COMPILER.setup` with `ifort.setup` if using if using bash and ifort compiler. 
Change `COMPILER.setup` to other configuration files in `config-setup` accordingly for other shells and compilers.

5) To set up the compilation configuration, evoke `./configure --disable-big-endian --prefix=$PARENT_DIR/PSU-EnKF_w_satellites/fortran_src/`.
Note that bash variable `PARENT_DIR` is the parent folder of crtm_v2.3.0 so that libraries will be directly placed in the folder of crtm_v2.3.0

6) Evoke `make; make install` to install.
If the CRTM is successfully installed, libcrtm.a will appear in the `lib` directory.



## Man-Yau Chan's compilation instructions

1) Enter the CRTM directory 
```
>> cd PSU-EnKF_w_satellites/fortran_src/crtm_v2.3.0/
```

2) Download coefficients tarball file for CRTM using provided bash script.
```
>> ./download_coefficients.sh
```

3) Untar the coefficients tarball file.
```
>> tar -xvf coefficients.*.tar
```

4) For ifort compiler users, setup relevant environment via 
```
>> . config-setup/ifort.setup
```
Change `ifort.setup` to other configuration files in `config-setup` accordingly for other shells and compilers.


5) To set up the compilation configuration, evoke 
```
>> ./configure --disable-big-endian --prefix=`pwd`
```

6) To install, run 
```
>> make; make install
```

7) Check if file `crtm_v2.3.0/lib/libcrtm.a` exists. If this file exists, compilation is successful.

8) Generate symbolic links needed for `EnSRF` to call CRTM by running
```
>> ln -s crtm_v2.3.0/* .
```

